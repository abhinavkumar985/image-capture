!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common"),require("@angular/core")):"function"==typeof define&&define.amd?define("ngx-webcam",["exports","@angular/common","@angular/core"],t):t(e["ngx-webcam"]={},e.ng.common,e.ng.core)}(this,function(e,t,i){"use strict";var u=function(){function e(e,t,i){this._mimeType=null,this._imageAsBase64=null,this._imageAsDataUrl=null,this._imageData=null,this._mimeType=t,this._imageAsDataUrl=e,this._imageData=i}return e.getDataFromDataUrl=function(e,t){return e.replace("data:"+t+";base64,","")},Object.defineProperty(e.prototype,"imageAsBase64",{get:function(){return this._imageAsBase64?this._imageAsBase64:this._imageAsBase64=e.getDataFromDataUrl(this._imageAsDataUrl,this._mimeType)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageAsDataUrl",{get:function(){return this._imageAsDataUrl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageData",{get:function(){return this._imageData},enumerable:!0,configurable:!0}),e}(),r=function(){function e(){}return e.getAvailableVideoInputs=function(){return navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?new Promise(function(t,i){navigator.mediaDevices.enumerateDevices().then(function(e){t(e.filter(function(e){return"videoinput"===e.kind}))})["catch"](function(e){i(e.message||e)})}):Promise.reject("enumerateDevices() not supported.")},e}(),a=function(){function c(){this.width=640,this.height=480,this.videoOptions=c.DEFAULT_VIDEO_OPTIONS,this.allowCameraSwitch=!0,this.captureImageData=!1,this.imageType=c.DEFAULT_IMAGE_TYPE,this.imageQuality=c.DEFAULT_IMAGE_QUALITY,this.imageCapture=new i.EventEmitter,this.initError=new i.EventEmitter,this.imageClick=new i.EventEmitter,this.cameraSwitched=new i.EventEmitter,this.availableVideoInputs=[],this.videoInitialized=!1,this.activeVideoInputIndex=-1,this.mediaStream=null,this.activeVideoSettings=null}return Object.defineProperty(c.prototype,"trigger",{set:function(e){var t=this;this.triggerSubscription&&this.triggerSubscription.unsubscribe(),this.triggerSubscription=e.subscribe(function(){t.takeSnapshot()})},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"switchCamera",{set:function(e){var t=this;this.switchCameraSubscription&&this.switchCameraSubscription.unsubscribe(),this.switchCameraSubscription=e.subscribe(function(e){"string"==typeof e?t.switchToVideoInput(e):t.rotateVideoInput(!1!==e)})},enumerable:!0,configurable:!0}),c.getMediaConstraintsForDevice=function(e,t){var i=t||this.DEFAULT_VIDEO_OPTIONS;return e&&(i.deviceId={exact:e}),i},c.getDeviceIdFromMediaStreamTrack=function(e){if(e.getSettings&&e.getSettings()&&e.getSettings().deviceId)return e.getSettings().deviceId;if(e.getConstraints&&e.getConstraints()&&e.getConstraints().deviceId){var t=e.getConstraints().deviceId;return c.getValueFromConstrainDOMString(t)}},c.getFacingModeFromMediaStreamTrack=function(e){if(e){if(e.getSettings&&e.getSettings()&&e.getSettings().facingMode)return e.getSettings().facingMode;if(e.getConstraints&&e.getConstraints()&&e.getConstraints().facingMode){var t=e.getConstraints().facingMode;return c.getValueFromConstrainDOMString(t)}}},c.isUserFacing=function(e){var t=c.getFacingModeFromMediaStreamTrack(e);return!!t&&"user"===t.toLowerCase()},c.getValueFromConstrainDOMString=function(e){if(e){if(e instanceof String)return String(e);if(Array.isArray(e)&&0<Array(e).length)return String(e[0]);if("object"==typeof e){if(e.exact)return String(e.exact);if(e.ideal)return String(e.ideal)}}return null},c.prototype.ngAfterViewInit=function(){var t=this;this.detectAvailableDevices().then(function(e){t.switchToVideoInput(0<e.length?e[0].deviceId:null)})["catch"](function(e){t.initError.next({message:e}),t.switchToVideoInput(null)})},c.prototype.ngOnDestroy=function(){this.stopMediaTracks(),this.unsubscribeFromSubscriptions()},c.prototype.takeSnapshot=function(){var e=this.video.nativeElement,t={width:this.width,height:this.height};e.videoWidth&&(t.width=e.videoWidth,t.height=e.videoHeight);var i=this.canvas.nativeElement;i.width=t.width,i.height=t.height;var a=i.getContext("2d");a.drawImage(this.video.nativeElement,0,0);var r=this.imageType?this.imageType:c.DEFAULT_IMAGE_TYPE,n=this.imageQuality?this.imageQuality:c.DEFAULT_IMAGE_QUALITY,o=i.toDataURL(r,n),s=null;this.captureImageData&&(s=a.getImageData(0,0,i.width,i.height)),this.imageCapture.next(new u(o,r,s))},c.prototype.rotateVideoInput=function(e){if(this.availableVideoInputs&&1<this.availableVideoInputs.length){var t=e?1:this.availableVideoInputs.length-1,i=(this.activeVideoInputIndex+t)%this.availableVideoInputs.length;this.switchToVideoInput(this.availableVideoInputs[i].deviceId)}},c.prototype.switchToVideoInput=function(e){this.videoInitialized=!1,this.stopMediaTracks(),this.initWebcam(e,this.videoOptions)},c.prototype.videoResize=function(){},Object.defineProperty(c.prototype,"videoWidth",{get:function(){var e=this.getVideoAspectRatio();return Math.min(this.width,this.height*e)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"videoHeight",{get:function(){var e=this.getVideoAspectRatio();return Math.min(this.height,this.width/e)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"videoStyleClasses",{get:function(){var e="";return this.isMirrorImage()&&(e+="mirrored "),e.trim()},enumerable:!0,configurable:!0}),c.prototype.getVideoAspectRatio=function(){var e=this.video.nativeElement;return e.videoWidth&&0<e.videoWidth&&e.videoHeight&&0<e.videoHeight?e.videoWidth/e.videoHeight:this.width/this.height},c.prototype.initWebcam=function(e,t){var i=this,a=this.video.nativeElement;if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){var r=c.getMediaConstraintsForDevice(e,t);navigator.mediaDevices.getUserMedia({video:r}).then(function(e){i.mediaStream=e,a.srcObject=e,a.play(),i.activeVideoSettings=e.getVideoTracks()[0].getSettings();var t=c.getDeviceIdFromMediaStreamTrack(e.getVideoTracks()[0]);i.activeVideoInputIndex=t?i.availableVideoInputs.findIndex(function(e){return e.deviceId===t}):-1,i.videoInitialized=!0,i.cameraSwitched.next(t)})["catch"](function(e){i.initError.next({message:e.message,mediaStreamError:e})})}else this.initError.next({message:"Cannot read UserMedia from MediaDevices."})},c.prototype.getActiveVideoTrack=function(){return this.mediaStream?this.mediaStream.getVideoTracks()[0]:null},c.prototype.isMirrorImage=function(){if(!this.getActiveVideoTrack())return!1;var e="auto";switch(this.mirrorImage&&("string"==typeof this.mirrorImage?e=String(this.mirrorImage).toLowerCase():this.mirrorImage.x&&(e=this.mirrorImage.x.toLowerCase())),e){case"always":return!0;case"never":return!1}return c.isUserFacing(this.getActiveVideoTrack())},c.prototype.stopMediaTracks=function(){this.mediaStream&&this.mediaStream.getTracks&&this.mediaStream.getTracks().forEach(function(e){return e.stop()})},c.prototype.unsubscribeFromSubscriptions=function(){this.triggerSubscription&&this.triggerSubscription.unsubscribe(),this.switchCameraSubscription&&this.switchCameraSubscription.unsubscribe()},c.prototype.detectAvailableDevices=function(){var a=this;return new Promise(function(t,i){r.getAvailableVideoInputs().then(function(e){a.availableVideoInputs=e,t(e)})["catch"](function(e){a.availableVideoInputs=[],i(e)})})},c.DEFAULT_VIDEO_OPTIONS={facingMode:"environment"},c.DEFAULT_IMAGE_TYPE="image/jpeg",c.DEFAULT_IMAGE_QUALITY=.92,c.decorators=[{type:i.Component,args:[{selector:"webcam",template:'<div class="webcam-wrapper" (click)="imageClick.next();">\r\n  <video #video [width]="videoWidth" [height]="videoHeight" [class]="videoStyleClasses" autoplay muted playsinline (resize)="videoResize()"></video>\r\n  <div class="camera-switch" *ngIf="allowCameraSwitch && availableVideoInputs.length > 1 && videoInitialized" (click)="rotateVideoInput(true)"></div>\r\n  <canvas #canvas [width]="width" [height]="height"></canvas>\r\n</div>\r\n',styles:[".webcam-wrapper{display:inline-block;position:relative;line-height:0}.webcam-wrapper video.mirrored{-webkit-transform:scale(-1,1);transform:scale(-1,1)}.webcam-wrapper canvas{display:none}.webcam-wrapper .camera-switch{background-color:rgba(0,0,0,.1);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAE9UlEQVR42u2aT2hdRRTGf+cRQqghSqihdBFDkRISK2KDfzDWxHaRQHEhaINKqa1gKQhd6EZLN+IidCH+Q0oWIkVRC21BQxXRitVaSbKoJSGtYGoK2tQ/tU1jY5v0c5F54Xl7b/KSO/PyEt+3e5f75p7zzZwzZ74zUEIJJfyfYaEGllQGVAGZlENdBy6Z2cSiYFTSKkkfS/pH/nBF0kFJdUW9AiRVASeAukD8DgNrzOySrwEzng18KaDzALXuG8W3AiStAvqBisBRNg40mtlPxbYCOgvgPO4bncWW+JpVeDQXRQhIygDfA00F5r0XuNfMrgclQFI98DDQCNQA5ZFXqoCWBVp8XwHRHeEqcN7loy/NbHBesyqpQ1KfFj/6nC+ZvFaApFrgPaCZpYVvgCfNbDiRAElNwGFg+RIt/X8H2s2s9wYCJDUAR4HqJX7++RN40MwGpgmQVAH0AQ2BPz4AHHPl8nBOAqtyFWQjsA6oL4Ada81sPDv7uwImod8kvSJp9RyS8O2SXnb/DYVd2Y9VSroQ4ANXJO2WVJmixqh0kzMWwL4LkiqRtDnA4D1zmfE8j9g9AezcnAHaPcfXdbfdnPZ2Yps6+DwAvO/Z1naTdApY7Xng48BDZnY1MpMVQBuw3iXc5Tnb0wBwBPjUzP6eoezuArZ6svM0geJLkvZEYnl3nkntoqROSbckSW2Suj3ZOIangc7GPJuUtNGdFIfmMeavktoSSKiW9LMPw30Q8JqkekmjCbOZRhuclLQjgYSNxUBAj6RyZ9ATgUJpUtJTCSR8vpAEXHAyWK5BXYFIGHOlepSAloUk4NEYgyoknQhEwhFJ0e8h6VSaQeerCb5uZgdi9utxYBNwOUD93hIVXswM4INCi6K9wAszFC2DwLOBDjHbYp59karIUnRdzYy/3ClqVklaUhfwTICj7K25OqA7a4wWagVsm4Me/xzwg2cCqqONFzO7DPxSCAJi436GUBgHHguQD2oTlJ55oSzP9ybccsttSJw1szdjFOSnI/8dTCGZHwcORp4Nx7y3B1iZ8/sm4MW8/Euxg5wIsS/HaAp3zeP4/G7obRDXI4jiTIA22H7Xdc7X+S3A5lC7QBQ357aq3VAjCeSkwUfAJrfvz+R8A9ADLAtZB+TinpjC5JMA+//jwPZZnF8G7J+L8z4IWB/zbG+gIujVWfLBW/NStVMmqaG4POJRsIjix7h8IGnLQuoBbQki5sVAJHyYm7YkNaRRtXwQ8G1cHpX0iKRrgUjYno17Sf0LrQhJUkdCeHWkVITGJI0k1QeS3ikGSUzOyJUJJNznYneuOCnpTldcxa2kP3xJYqOeSDjqZG8ShJLnE8TTuMS6Iyu1BW7djZqkfo9N0QOuYJmYQddfB7RG+gLTNzqAY9FrL+5/nwEbvDdJJe3zzOrhNP3AWRqmk55t3ZcBuj3b2gb0Sbrbo/NNzk7fFzu7s/E5EiC+rrmeQU0Kx2skvRFoOx2ZzlmSdgbsw49JetvtBpk8nM64d/cGbNtJ0s7cGyJlwHeEv+t3nqnLSgPAUOSGyG3AHUxdzqoJbEcvcL+ZTeTeEapzJKxgaeOcc/7Mf06D7kFrguS0VDAMtGadv+E47DT9tcChJej8ISfpD+abgTe45uOkFi8mnQ+JBVQ+d4VXuOptjavcyot8pq86mfwk8LWZnaOEEkoooYQSSojDv8AhQNeGfe0jAAAAAElFTkSuQmCC);background-repeat:no-repeat;border-radius:5px;position:absolute;right:13px;top:10px;height:48px;width:48px;background-size:80%;cursor:pointer;background-position:center;transition:background-color .2s}.webcam-wrapper .camera-switch:hover{background-color:rgba(0,0,0,.18)}"]}]}],c.propDecorators={width:[{type:i.Input}],height:[{type:i.Input}],videoOptions:[{type:i.Input}],allowCameraSwitch:[{type:i.Input}],mirrorImage:[{type:i.Input}],captureImageData:[{type:i.Input}],imageType:[{type:i.Input}],imageQuality:[{type:i.Input}],imageCapture:[{type:i.Output}],initError:[{type:i.Output}],imageClick:[{type:i.Output}],cameraSwitched:[{type:i.Output}],video:[{type:i.ViewChild,args:["video"]}],canvas:[{type:i.ViewChild,args:["canvas"]}],trigger:[{type:i.Input}],switchCamera:[{type:i.Input}]},c}(),n=[a],o=function(){function e(){}return e.decorators=[{type:i.NgModule,args:[{imports:[t.CommonModule],declarations:[n],exports:[n]}]}],e}(),s=function g(){this.message=null,this.mediaStreamError=null},c=function d(){};e.WebcamModule=o,e.WebcamComponent=a,e.WebcamImage=u,e.WebcamInitError=s,e.WebcamMirrorProperties=c,e.WebcamUtil=r,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-webcam.umd.min.js.map